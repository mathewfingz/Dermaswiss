<div class="monthly-calendar container section-{{ section.id }}">
  <div class="calendar-header">
    <h2 class="h2">{{ section.settings.heading | default: 'Monthly Calendar' }}</h2>
    <div class="calendar-nav">
      <button id="prevMonth" class="btn btn--secondary btn--small">
        {% render 'icon-arrow-left' %}
      </button>
      <h3 id="currentMonthYear" class="h4"></h3>
      <button id="nextMonth" class="btn btn--secondary btn--small">
        {% render 'icon-arrow-right' %}
      </button>
    </div>
  </div>
  <div class="calendar-body">
    <div class="calendar-weekdays">
      <div>Dom</div>
      <div>Lun</div>
      <div>Mar</div>
      <div>Mié</div>
      <div>Jue</div>
      <div>Vie</div>
      <div>Sáb</div>
    </div>
    <div id="calendarDays" class="calendar-days"></div>
  </div>
</div>

<style>
  .monthly-calendar {
    margin-top: 40px;
    margin-bottom: 40px;
  }
  .calendar-header {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 20px;
    margin-bottom: 30px;
  }
  .calendar-nav {
    display: flex;
    align-items: center;
    gap: 30px;
  }
  .calendar-weekdays {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    text-align: center;
    font-weight: bold;
    background: #f4f4f4;
    padding: 10px 0;
    border-top: 1px solid #ddd;
    border-bottom: 1px solid #ddd;
  }
  .calendar-days {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    border-left: 1px solid #ddd;
    border-bottom: 1px solid #ddd;
  }
  .calendar-day {
    min-height: 100px;
    padding: 10px;
    border-right: 1px solid #ddd;
    border-top: 1px solid #ddd;
    position: relative;
    background: #fff;
  }
  .calendar-day.empty {
    background: #fafafa;
  }
  .calendar-day.today {
    background: #fff9e6;
  }
  .day-number {
    font-weight: bold;
    margin-bottom: 5px;
    display: block;
  }
  .event-placeholder {
    font-size: 10px;
    color: #666;
    margin-top: 4px;
  }
  @media (max-width: 767px) {
    .calendar-day {
      min-height: 60px;
      font-size: 12px;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const calendarDays = document.getElementById('calendarDays');
    const currentMonthYear = document.getElementById('currentMonthYear');
    const prevMonthBtn = document.getElementById('prevMonth');
    const nextMonthBtn = document.getElementById('nextMonth');

    let currentDate = new Date();

    function renderCalendar(date) {
      calendarDays.innerHTML = '';
      const year = date.getFullYear();
      const month = date.getMonth();

      const firstDayOfMonth = new Date(year, month, 1).getDay();
      const lastDayOfMonth = new Date(year, month + 1, 0).getDate();
      const today = new Date();

      const monthNames = ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio",
        "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"
      ];

      currentMonthYear.innerText = `${monthNames[month]} ${year}`;

      // Days from previous month
      for (let i = 0; i < firstDayOfMonth; i++) {
        const emptyDay = document.createElement('div');
        emptyDay.classList.add('calendar-day', 'empty');
        calendarDays.appendChild(emptyDay);
      }

      // Actual days
      for (let day = 1; day <= lastDayOfMonth; day++) {
        const dayElement = document.createElement('div');
        dayElement.classList.add('calendar-day');
        
        if (day === today.getDate() && month === today.getMonth() && year === today.getFullYear()) {
          dayElement.classList.add('today');
        }

        dayElement.innerHTML = `<span class="day-number">${day}</span>`;
        calendarDays.appendChild(dayElement);
      }
    }

    prevMonthBtn.addEventListener('click', () => {
      currentDate.setMonth(currentDate.getMonth() - 1);
      renderCalendar(currentDate);
    });

    nextMonthBtn.addEventListener('click', () => {
      currentDate.setMonth(currentDate.getMonth() + 1);
      renderCalendar(currentDate);
    });

    renderCalendar(currentDate);
  });
</script>

{% schema %}
{
  "name": "Monthly Calendar",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Calendario Mensual"
    }
  ],
  "presets": [
    {
      "name": "Monthly Calendar"
    }
  ]
}
{% endschema %}

